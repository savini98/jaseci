exclude: |
    (?x)(
        ^jac/jaclang/vendor/|
        ^jac/jaclang/pycore/lark_jac_parser\.py$|
        ^jac/jaclang/pycore/lark_ts_parser\.py$|
        ^$
    )

# Skip jac-check on pre-commit.ci - it times out (180s limit) due to cold cache.
# Type checking should run in GitHub Actions instead where we control caching.
ci:
  skip: [jac-check]

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: check-yaml
        args: [--allow-multiple-documents, --unsafe]
      - id: check-json
      - id: trailing-whitespace
      - id: mixed-line-ending
        args: [--fix=lf]
      - id: end-of-file-fixer
  - repo: https://github.com/DavidAnson/markdownlint-cli2
    rev: v0.20.0
    hooks:
    - id: markdownlint-cli2
      args: [--fix]
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.14
    hooks:
      - id: ruff
        args: [--fix]
      - id: ruff-format
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.19.1
    hooks:
      - id: mypy
        args:
          - --ignore-missing-imports
          - --config-file=mypy.ini
          - --explicit-package-bases
        additional_dependencies: [types-PyYAML, types-requests]
        exclude: (/fixtures/|lark_jac_parser\.py|lark_ts_parser\.py|/vendor/|/scripts/|jac/examples/reference)
  - repo: local
    hooks:
      - id: jac-format
        name: jac-format
        description: Format Jac files with consistent code style
        entry: env PYTHONPATH=jac python3 -m jaclang format
        language: python
        types: [file]
        args: [--fix]
        files: \.jac$
        require_serial: true
        exclude: (/fixtures/|_err\.jac$|_syntax_err\.jac$)
        additional_dependencies: [llvmlite>=0.43.0]
      - id: jac-check
        name: jac-check
        description: Type check Jac files
        entry: env PYTHONPATH=jac python3 -m jaclang check --warnonly
        language: system
        types: [file]
        files: \.jac$
        require_serial: true
        exclude: (/fixtures/|_err\.jac$|_syntax_err\.jac$|jac-client/jac_client/examples/)
  - repo: local
    hooks:
      - id: check-no-binary-files
        name: Check for binary files
        entry: Binary files are not allowed
        language: fail
        types: [binary]
        exclude: |
          (?x)(
              ^jac-client/jac_client/examples/all-in-one/assets/burger.png$|
              ^docs/docs/assets/debug_mode\.jpg$|
              ^docs/docs/assets/examples/jac_book/node1\.png$|
              ^docs/docs/assets/examples/jac_book/node2\.png$|
              ^docs/docs/assets/examples/jac_book/node3\.png$|
              ^docs/docs/assets/examples/jac_book/with_entry\.png$|
              ^docs/docs/assets/jac_cloud_example\.jpg$|
              ^docs/docs/assets/logo\.png$|
              ^docs/docs/assets/org1_logo\.png$|
              ^docs/docs/assets/org2_logo\.png$|
              ^docs/docs/assets/org3_logo\.png$|
              ^docs/docs/assets/visualizer\.jpg$|
              ^docs/docs/learn/assets/debugger/debugger-complex_function-breakpoint\.png$|
              ^docs/docs/learn/assets/debugger/debugger-complex_function-options\.png$|
              ^docs/docs/learn/assets/debugger/debugger-complex_function-run\.png$|
              ^docs/docs/learn/assets/debugger/debugger-complex_function\.png$|
              ^docs/docs/learn/assets/debugger/debugger-extension\.png$|
              ^docs/docs/learn/assets/debugger/debugger-visualization-open-tool\.png$|
              ^docs/docs/learn/assets/jac-lens/jac-lens-create-session\.gif$|
              ^docs/docs/learn/assets/jac-lens/jac-lens-download\.gif$|
              ^docs/docs/learn/assets/jac-lens/jac-lens-explore-graphs\.gif$|
              ^docs/docs/learn/assets/jac-lens/jac-lens-logo\.png$|
              ^docs/docs/learn/assets/jac-lens/jac-lens-modify-graph\.gif$|
              ^docs/docs/learn/examples/EmailBuddy/assets/EmailBuddy-agentic\.png$|
              ^docs/docs/learn/examples/EmailBuddy/assets/EmailBuddy-osp-unconnected_graph\.png$|
              ^docs/docs/learn/examples/EmailBuddy/assets/EmailBuddy-osp_diagram\.png$|
              ^docs/docs/learn/examples/EmailBuddy/assets/EmailBuddy-scale-native-FastAPI-Docs\.png$|
              ^docs/docs/learn/examples/agentic_ai/aider-genius-lite/aider\.png$|
              ^docs/docs/learn/examples/agentic_ai/friendzone-lite/friendzone\.png$|
              ^docs/docs/learn/examples/agentic_ai/task-manager-lite/task\ manager\.png$|
              ^docs/docs/learn/examples/littleX/src/front_end\.png$|
              ^docs/docs/learn/examples/rag_chatbot/images/chatbot\.jpg$|
              ^docs/docs/learn/examples/rag_chatbot/images/image_chat\.jpg$|
              ^jac-byllm/examples/agentic_ai/task-manager-lite/task_manager\.png$|
              ^jac-byllm/examples/vision/math_question\.jpg$|
              ^jac-byllm/examples/vision/mugen\.mp4$|
              ^jac-byllm/examples/vision/person\.png$|
              ^jac-byllm/examples/vision/receipt\.jpg$|
              ^jac-byllm/tests/fixtures/SampleVideo_1280x720_2mb\.mp4$|
              ^jac-byllm/tests/fixtures/alan-m-turing\.jpg$|
              ^jac-byllm/tests/fixtures/image\.jpg$|
              ^jac-byllm/tests/fixtures/math_question\.jpg$|
              ^jac-byllm/tests/fixtures/webp_image_of_person\.webp$|
              ^jac-client/jac_client/examples/asset-serving/css-with-image/assets/burger\.png$|
              ^jac-client/jac_client/examples/asset-serving/image-asset/assets/burger\.png$|
              ^jac-client/jac_client/examples/asset-serving/import-alias/assets/burger\.png$|
              ^jac/examples/rpg_game/jac_impl/fonts/8bitoperator_jve\.ttf$|
              ^jac/examples/rpg_game/lib_mode/8bitoperator_jve\.ttf$|
              ^jac/examples/rpg_game/python_impl/8bitoperator_jve\.ttf$
          )

      - id: ban-em-dashes
        name: Ban em-dashes (—)
        language: pygrep
        entry: '—'
        types: [markdown]
